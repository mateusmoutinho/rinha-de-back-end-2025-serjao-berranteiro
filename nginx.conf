events {
    worker_connections 1024;
}

http {
    upstream backend {
        server api1:3000;
        server api1:3001;
        server api1:3002;
        server api1:3003;
        server api1:3004;
        server api1:3005;
        server api1:3006;
        server api1:3007;
        server api1:3008;
        server api1:3009;
        server api1:3010;
        server api1:3011;
        server api1:3012;
        server api1:3013;
        server api1:3014;
        server api1:3015;
        server api1:3016;
        server api1:3017;
        server api1:3018;
        server api1:3019;
        server api1:3020;
        server api1:3021;
        server api1:3022;
        server api1:3023;
        server api1:3024;
        server api1:3025;
        server api1:3026;
        server api1:3027;
        server api1:3028;
        server api1:3029;
        server api1:3030;
        server api1:3031;
        server api1:3032;
        server api1:3033;
        server api1:3034;
        server api1:3035;
        server api1:3036;
        server api1:3037;
        server api1:3038;
        server api1:3039;
        server api1:3040;
        server api1:3041;
        server api1:3042;
        server api1:3043;
        server api1:3044;
        server api1:3045;
        server api1:3046;
        server api1:3047;
        server api1:3048;
        server api1:3049;
        server api1:3050;
        server api1:3051;
        server api1:3052;
        server api1:3053;
        server api1:3054;
        server api1:3055;
        server api1:3056;
        server api1:3057;
        server api1:3058;
        server api1:3059;
        server api1:3060;
        server api1:3061;
        server api1:3062;
        server api1:3063;
        server api1:3064;
        server api1:3065;
        server api1:3066;
        server api1:3067;
        server api1:3068;
        server api1:3069;
        server api1:3070;
        server api1:3071;
        server api1:3072;
        server api1:3073;
        server api1:3074;
        server api1:3075;
        server api1:3076;
        server api1:3077;
        server api1:3078;
        server api1:3079;
        server api1:3080;
        server api1:3081;
        server api1:3082;
        server api1:3083;
        server api1:3084;
        server api1:3085;
        server api1:3086;
        server api1:3087;
        server api1:3088;
        server api1:3089;
        server api1:3090;
        server api1:3091;
        server api1:3092;
        server api1:3093;
        server api1:3094;
        server api1:3095;
        server api1:3096;
        server api1:3097;
        server api1:3098;
        server api1:3099;
        server api1:3100;
        server api2:3101;
        server api2:3102;
        server api2:3103;
        server api2:3104;
        server api2:3105;
        server api2:3106;
        server api2:3107;
        server api2:3108;
        server api2:3109;
        server api2:3110;
        server api2:3111;
        server api2:3112;
        server api2:3113;
        server api2:3114;
        server api2:3115;
        server api2:3116;
        server api2:3117;
        server api2:3118;
        server api2:3119;
        server api2:3120;
        server api2:3121;
        server api2:3122;
        server api2:3123;
        server api2:3124;
        server api2:3125;
        server api2:3126;
        server api2:3127;
        server api2:3128;
        server api2:3129;
        server api2:3130;
        server api2:3131;
        server api2:3132;
        server api2:3133;
        server api2:3134;
        server api2:3135;
        server api2:3136;
        server api2:3137;
        server api2:3138;
        server api2:3139;
        server api2:3140;
        server api2:3141;
        server api2:3142;
        server api2:3143;
        server api2:3144;
        server api2:3145;
        server api2:3146;
        server api2:3147;
        server api2:3148;
        server api2:3149;
        server api2:3150;
        server api2:3151;
        server api2:3152;
        server api2:3153;
        server api2:3154;
        server api2:3155;
        server api2:3156;
        server api2:3157;
        server api2:3158;
        server api2:3159;
        server api2:3160;
        server api2:3161;
        server api2:3162;
        server api2:3163;
        server api2:3164;
        server api2:3165;
        server api2:3166;
        server api2:3167;
        server api2:3168;
        server api2:3169;
        server api2:3170;
        server api2:3171;
        server api2:3172;
        server api2:3173;
        server api2:3174;
        server api2:3175;
        server api2:3176;
        server api2:3177;
        server api2:3178;
        server api2:3179;
        server api2:3180;
        server api2:3181;
        server api2:3182;
        server api2:3183;
        server api2:3184;
        server api2:3185;
        server api2:3186;
        server api2:3187;
        server api2:3188;
        server api2:3189;
        server api2:3190;
        server api2:3191;
        server api2:3192;
        server api2:3193;
        server api2:3194;
        server api2:3195;
        server api2:3196;
        server api2:3197;
        server api2:3198;
        server api2:3199;
        server api2:3200;
    }
    
    server {
        listen 9999;
        
        location / {
            proxy_pass http://backend;
            proxy_set_header Host $host;
            proxy_set_header X-Real-IP $remote_addr;
            proxy_set_header X-Forwarded-For $proxy_add_x_forwarded_for;
            proxy_set_header X-Forwarded-Proto $scheme;
        }
    }
}
